$(function(){new SearchView;Handlebars.registerHelper("format",function(a){return a?(a=a.replace(/[@]+[A-Za-z0-9-_]+/g,function(a){var b=a.replace("@","");return a.link("https://twitter.com/"+b)}),new Handlebars.SafeString(a)):a})});var Tweets=Backbone.Collection.extend({model:Tweet,url:"api/twitter/tweets",initialize:function(){}}),Tweet=Backbone.Model.extend({url:"api/twitter/tweets",parse:function(a){var b=moment(a.created_at,"ddd MMM DD HH:mm:ss ZZ YYYY").fromNow();return a.date=b,a}}),ProfileView=Backbone.View.extend({el:"#profile",template:Handlebars.compile($("#profile-template").html()),model:null,initialize:function(a){this.model=a,console.log(this.model),this.render(),this.listenTo(this.model,"change",this.render)},render:function(){console.log(this.model.toJSON());var a=this.template({user:this.model.toJSON()});return this.$el.html(a),this}}),SearchView=Backbone.View.extend({el:"#search",model:null,events:{"click #submitsearch":"submit"},initialize:function(){},submit:function(a){query=$("#searchForUser").val(),a.preventDefault(),console.log("Search for"+query);var b=new Tweets;b.fetch({data:{data:query},type:"POST",success:function(a,b,c){console.log(a);new ProfileView(a.models[0]),new TweetListView(a)}})}}),TweetListView=Backbone.View.extend({el:"#tweetlist",template:Handlebars.compile($("#tweetlist-template").html()),tweetlist:null,initialize:function(a){this.tweetlist=a,console.log(this.tweetlist.models),this.render(),this.listenTo(this.tweetlist,"reset",this.render)},render:function(){if(this.$el.empty(),this.unbind(),this.tweetlist.models.length>0){console.log("i'm being rendered! ",this.tweetlist.toJSON());var a=this.template({tweet:this.tweetlist.toJSON()});this.$el.append(a)}return this}});